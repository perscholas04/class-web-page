"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@aws-amplify/auth"),a=require("@aws-amplify/core"),r=require("@aws-amplify/datastore"),i=require("@aws-amplify/storage"),s=require("./utils-fb304b5c.js"),o=require("aws-amplify");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}require("lodash/isEmpty"),require("lodash/isArray"),require("lodash/isObject");var c=d(e),u=n(t);const l=({model:e,criteria:t,pagination:a})=>{const[i,s]=c.useState({items:[],isLoading:!1,error:void 0});return c.useEffect((()=>{s({isLoading:!0,items:[]});const i=r.DataStore.observeQuery(e,t,a).subscribe((e=>s({items:e.items,isLoading:!1})),(e=>s({items:[],error:e,isLoading:!1})));if(i)return()=>i.unsubscribe()}),[]),i},f=({model:e,id:t})=>{const[a,i]=c.useState(),[s,o]=c.useState(!1),[n,d]=c.useState();return c.useEffect((()=>{o(!0),r.DataStore.query(e,t).then(i).catch(d).finally((()=>o(!1)))}),[]),{error:n,item:a,isLoading:s}};const p="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default";const h=({fields:e,modelName:t,schema:a})=>c.useMemo((()=>{if(function(e,t){return!t}(0,a))return e;let r={};return Object.keys(e).forEach((i=>{var s,o,n;switch(null===(n=null===(o=null===(s=null==a?void 0:a.models[t])||void 0===s?void 0:s.fields)||void 0===o?void 0:o[i])||void 0===n?void 0:n.type){case"AWSTimestamp":case"Float":r[i]=Number(e[i]);break;case"Boolean":r[i]=Boolean(e[i]);break;case"Int":r[i]=parseInt(e[i]);break;default:r[i]=e[i]}})),r}),[e,a,t]),v=e=>e.reduce(((e,t)=>a=>t(e(a))),(e=>e)),g=e=>{const{and:t,or:a,field:r,operator:i,operand:o}=e;if(Array.isArray(t)){const e=t.map((e=>g(e)));return t=>t.and(v(e))}if(Array.isArray(a)){const e=a.map((e=>g(e)));return t=>t.or(v(e))}return e=>s.isFunction(e[r])?e[r].call(e,i,o):e};exports.findChildOverrides=s.findChildOverrides,exports.getOverrideProps=s.getOverrideProps,exports.getOverridesFromVariants=s.getOverridesFromVariants,exports.mergeVariantsAndOverrides=s.mergeVariantsAndOverrides,exports.createDataStorePredicate=g,exports.useAuth=()=>{const[e,t]=c.useState({error:void 0,isLoading:!0,user:void 0}),r=({payload:e})=>{switch(e.event){case"signIn":return t({user:e.data,isLoading:!1});case"signOut":return t({isLoading:!1})}},i=()=>(t({isLoading:!0}),u.default.currentAuthenticatedUser().then((e=>t({user:e,isLoading:!1}))).catch((e=>t({error:e,isLoading:!1}))),a.Hub.listen("auth",r),()=>a.Hub.remove("auth",r));return c.useEffect(i,[]),Object.assign(Object.assign({},e),{fetch:i})},exports.useAuthSignOutAction=e=>()=>s.__awaiter(void 0,void 0,void 0,(function*(){try{o.Hub.dispatch("ui",{event:"actions:auth:signout:started",data:{options:e}},"actions:auth:signout",p),yield o.Auth.signOut(e),o.Hub.dispatch("ui",{event:"actions:auth:signout:finished",data:{options:e}},"actions:auth:signout",p)}catch(t){o.Hub.dispatch("ui",{event:"actions:auth:signout:finished",data:{options:e,errorMessage:s.getErrorMessage(t)}},"actions:auth:signout",p)}})),exports.useDataStoreBinding=function(e){return"record"===e.type?f(e):l(e)},exports.useDataStoreCollection=l,exports.useDataStoreCreateAction=({model:e,fields:t,schema:a})=>{const r=h({fields:t,modelName:e.name,schema:a});return()=>s.__awaiter(void 0,void 0,void 0,(function*(){try{o.Hub.dispatch("ui",{event:"actions:datastore:create:started",data:{fields:r}},"actions:datastore:create",p);const t=yield o.DataStore.save(new e(r));o.Hub.dispatch("ui",{event:"actions:datastore:create:finished",data:{fields:r,item:t}},"actions:datastore:create",p)}catch(e){o.Hub.dispatch("ui",{event:"actions:datastore:create:finished",data:{fields:r,errorMessage:s.getErrorMessage(e)}},"actions:datastore:create",p)}}))},exports.useDataStoreDeleteAction=({model:e,id:t})=>()=>s.__awaiter(void 0,void 0,void 0,(function*(){try{o.Hub.dispatch("ui",{event:"actions:datastore:delete:started",data:{id:t}},"actions:datastore:delete",p),yield o.DataStore.delete(e,t),o.Hub.dispatch("ui",{event:"actions:datastore:delete:finished",data:{id:t}},"actions:datastore:delete",p)}catch(e){o.Hub.dispatch("ui",{event:"actions:datastore:delete:finished",data:{id:t,errorMessage:s.getErrorMessage(e)}},"actions:datastore:delete",p)}})),exports.useDataStoreItem=f,exports.useDataStoreUpdateAction=({fields:e,id:t,model:a,schema:r})=>{const i=h({fields:e,modelName:a.name,schema:r});return()=>s.__awaiter(void 0,void 0,void 0,(function*(){try{o.Hub.dispatch("ui",{event:"actions:datastore:update:started",data:{fields:i,id:t}},"actions:datastore:update",p);const e=yield o.DataStore.query(a,t);if(!e)throw new Error(`Error querying datastore item by id: ${t}`);const r=yield o.DataStore.save(a.copyOf(e,(e=>{Object.assign(e,i)})));o.Hub.dispatch("ui",{event:"actions:datastore:update:finished",data:{fields:i,id:t,item:r}},"actions:datastore:update",p)}catch(e){o.Hub.dispatch("ui",{event:"actions:datastore:update:finished",data:{fields:i,id:t,errorMessage:s.getErrorMessage(e)}},"actions:datastore:update",p)}}))},exports.useNavigateAction=e=>{const{type:t,url:a,anchor:r,target:i}=e,s=c.useMemo((()=>{switch(t){case"url":return()=>{window.open(a,i||"_self","noopener noreferrer")};case"anchor":return()=>{window.location.hash=r};case"reload":return()=>{window.location.reload()};default:return()=>{console.warn('Please provide a valid navigate type. Available types are "url", "anchor" and "reload".')}}}),[r,i,t,a]);return()=>{o.Hub.dispatch("ui",{event:"actions:core:navigate:started",data:e},"actions:core:navigate",p),s(),o.Hub.dispatch("ui",{event:"actions:core:navigate:finished",data:e},"actions:core:navigate",p)}},exports.useStateMutationAction=e=>{const[t,a]=c.useState(e),r=c.useCallback((e=>{const r=t;o.Hub.dispatch("ui",{event:"actions:core:statemutation:started",data:{prevState:r,newState:e}},"actions:core:statemutation",p),a(e),o.Hub.dispatch("ui",{event:"actions:core:statemutation:finished",data:{prevState:r,newState:e}},"actions:core:statemutation",p)}),[t]);return[t,r]},exports.useStorageURL=(e,t)=>{const[a,r]=c.useState({isLoading:!0}),s=JSON.stringify(t),o=()=>{r({isLoading:!0});const a=i.Storage.get(e,t);return a.then((e=>r({url:e,isLoading:!1}))).catch((e=>r({error:e,isLoading:!1}))),()=>i.Storage.cancel(a)};return c.useEffect(o,[e,t,s]),Object.assign(Object.assign({},a),{fetch:o})};
